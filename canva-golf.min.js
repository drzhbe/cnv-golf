let d=document,c=d.querySelector('canvas'),w=this,W=w.innerWidth,H=w.innerHeight,l=d.addEventListener,X=c.getContext('2d'),D=devicePixelRatio||1,F=20,Z='Golf Wang',E=[],A,a,u,L=e=>{e.target.href=c.toDataURL()
e.target.download=Z+'.png'},I=e=>e.preventDefault()||[...e.dataTransfer.items].map(i => i.getAsFile()).map((f,i)=>{i=new Image()
i.onload=_=>{let a=i.width,b=i.height,c=a,d=b;a>b?a>W&&(c=W,d=b*W/a):b>H&&(d=H,c=a*d/b);E.unshift([0,i,0,0,c,d])}
i.src=URL.createObjectURL(f)}),r=_=>(X.clearRect(0,0,W,H),E.map(([t,c,x,y,w,h])=>t?X.fillText(c,x,y+F):X.drawImage(c,x,y,w,h)),requestAnimationFrame(r))
c.width=W*D
c.height=H*D
X.scale(D,D)
X.font=F+'pt Serif'
l('mousedown',({x,y},e)=>{e=A=[...E].reverse().find(([t,c,X,Y,W,H])=>x>X&&x<X+W&&y>Y&&y<Y+H)
a=e&&{e,X:x-e[2],Y:y-e[3]}})
l('mouseup',_=>a=u)
l('mousemove',p=>a&&(a.e[2]=p.x-a.X,a.e[3]=p.y-a.Y))
l('keydown',(e,w,i)=>(e.key=='t'&&(w=X.measureText(Z).width)&&E.push([1,Z,W/2-w/2,H/2-F,w,F]),e.which==8&&(E=E.filter(e=>e!=A))))
r()
